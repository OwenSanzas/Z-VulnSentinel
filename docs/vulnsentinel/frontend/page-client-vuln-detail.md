# 客户漏洞详情页 — Client Vulnerability Detail

> 路由: `/client-vuln/:id`
> 数据来源：client_vulns 表

从漏洞列表页点击漏洞行进入，或从项目详情页 Client Vulnerabilities 表点击进入，或从上游漏洞详情页 Client Impact 表点击进入。

```
┌──────────────────────────────────────────────────────────────────────────────────┐
│  ◉ VulnSentinel                                                O2Lab  │  Admin ▾ │
├──────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  ← Back                                                                          │
│                                                                                  │
│  ┌──────────────────────────────────────────────────────────────────────────────┐ │
│  │  CLIENT VULNERABILITY #78                                status: reported   │ │
│  │  Project: ProjA                                                             │ │
│  │  Library: zlib/zlib                                                         │ │
│  │  Upstream Vuln: #42 Buffer Over-read (CWE-126) HIGH        view upstream →  │ │
│  └──────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                  │
│  Status Timeline                                                                 │
│  ────────────────────────────────────────────────────────────────────────────     │
│                                                                                  │
│  ● recorded ──────── ● reported ──────── ○ confirmed ──────── ○ fixed           │
│  Feb 15 14:35        Feb 15 16:20                                                │
│                                                                                  │
│  Version Analysis                                                                │
│  ────────────────────────────────────────────────────────────────────────────     │
│                                                                                  │
│  ┌──────────────────────────────────────────────────────────────────────────────┐ │
│  │  Constraint:    >= 1.3, < 2.0       (from conanfile.txt)                    │ │
│  │  Resolved:      v1.3.1                                                      │ │
│  │  Fix Version:   v1.3.2                                                      │ │
│  │  Verdict:       ⚠ v1.3.1 < v1.3.2 — 客户版本在受影响范围内                   │ │
│  └──────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                  │
│  Reachable Path                                                                  │
│  ────────────────────────────────────────────────────────────────────────────     │
│                                                                                  │
│  ┌──────────────────────────────────────────────────────────────────────────────┐ │
│  │  main()                                           [proj-a/src/main.c:42]    │ │
│  │    → process_data()                               [proj-a/src/data.c:128]   │ │
│  │      → decompress_stream()                        [proj-a/src/io.c:67]      │ │
│  │        → inflate()                                [zlib/inflate.c:623]       │ │
│  │          → inflate_fast()  ⚠ VULNERABLE           [zlib/inffast.c:1042]     │ │
│  └──────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                  │
│  PoC Results                                                                     │
│  ────────────────────────────────────────────────────────────────────────────     │
│                                                                                  │
│  ┌──────────────────────────────────────────────────────────────────────────────┐ │
│  │  Status: pending                                                            │ │
│  │  (等待 PoC 生成，可达路径已确认)                                               │ │
│  └──────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                  │
│  Report                                                                          │
│  ────────────────────────────────────────────────────────────────────────────     │
│                                                                                  │
│  ┌──────────────────────────────────────────────────────────────────────────────┐ │
│  │  Reported to: alice@client-org.com                                          │ │
│  │  Reported at: 2026-02-15 16:20                                              │ │
│  │  Method: email                                                              │ │
│  │  Content: "zlib buffer over-read vulnerability detected in ProjA..."        │ │
│  └──────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                  │
└──────────────────────────────────────────────────────────────────────────────────┘
```

## 区域说明

| 区域 | 数据来源 | 说明 |
|------|----------|------|
| **漏洞信息头** | client_vulns + upstream_vulns | 客户漏洞 ID、项目、库、关联的上游漏洞摘要、当前状态 |
| **Status Timeline** | client_vulns 时间戳 | 可视化状态流转：recorded → reported → confirmed → fixed，已到达的状态实心●，未到达的空心○，标注各状态到达时间 |
| **Version Analysis** | client_vulns + 项目依赖 | 客户版本约束、实际使用版本、修复版本、判定理由 |
| **Reachable Path** | 分析流水线结果 | 从客户代码入口到漏洞函数的调用链，标注源文件和行号 |
| **PoC Results** | 分析流水线结果 | PoC 生成结果：成功/失败/进行中，如有则展示 PoC 详情 |
| **Report** | client_vulns | 通知记录：通知谁、何时、用什么方式、内容摘要。仅 status ≥ reported 时展示 |

## Status Timeline

时间线可视化四个状态节点：

```
● recorded ──────── ● reported ──────── ● confirmed ──────── ○ fixed
Feb 15 14:35        Feb 15 16:20        Feb 16 09:10
```

- ● 实心 = 已到达，下方显示时间
- ○ 空心 = 未到达
- `not_affect` 特殊展示：只有一个节点 `● not_affect`，无时间线

## PoC Results 详情

当 PoC 生成成功时，展示：

| 数据 | 说明 |
|------|------|
| **PoC 类型** | 基于上游 PoC 改造 / 自动生成 |
| **触发输入** | 触发漏洞的输入文件或构造方法 |
| **崩溃信息** | sanitizer 输出、crash backtrace |
| **复现命令** | 用于验证的命令行 |

## Error 状态展示

如果分析流水线在此客户项目上失败，漏洞信息头下方显示：

```
│  ┌──────────────────────────────────────────────────────────────────────────────┐ │
│  │  ❌ Analysis Error: bitcode build failed: missing dependency libssl-dev     │ │
│  └──────────────────────────────────────────────────────────────────────────────┘ │
```

此时 Status Timeline、Reachable Path、PoC Results 不展示（分析未完成，client_vuln 未生成）。

## 交互

| 操作 | 跳转 |
|------|------|
| 点击 `← Back` | 返回上一页（浏览器 history.back） |
| 点击信息头中 Project 名 | [项目详情页](page-project-detail.md) |
| 点击信息头中 Library 名 | [库详情页](page-library-detail.md) |
| 点击 `view upstream →` | [上游漏洞详情页](page-upstream-vuln-detail.md) |
| 点击 Reachable Path 中触发 commit | [事件详情页](page-event-detail.md) |
